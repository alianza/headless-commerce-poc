name: Lighthouse CI
on: push
jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: copy .env
        run: cp framework/shopify/.env.template .env.local
      - name: Install
        run: yarn install
      - name: build
        run: yarn run build
      - name: Start server
        run: yarn run start
      - name: Audit URLs using Lighthouse against a static dist dir
        uses: treosh/lighthouse-ci-action@v7
        with:
          urls: |
            https://localhost:3001/
            https://localhost:3001/orders
          uploadArtifacts: true # save results as an action artifacts
          temporaryPublicStorage: true # upload lighthouse report to the temporary storage
